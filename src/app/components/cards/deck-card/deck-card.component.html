<ng-template *ngIf="fullCards" [ngTemplateOutlet]="fullCard"></ng-template>
<ng-template *ngIf="!fullCards" [ngTemplateOutlet]="smallCard"></ng-template>

<ng-template #fullCard>
  <div class="inline-flex relative card">
    <img [src]="card.cardImage" alt="Digimon Card" class="card-image m-auto z-50" (click)="showCardDetails()" (contextmenu)="showCardDetails()">

    <div *ngIf="missingCards" class="absolute inline-flex ml-auto">
      <i class="pi pi-times text-white"></i>
      <p class="font-bold text-xl text-white">{{cardHave - card.count > 0 ? 0 : cardHave - card.count}}</p>
    </div>

    <p-inputNumber *ngIf="edit" (onInput)="changeCardCount($event)"
      class="card-count" [min]="0" [max]="card.cardNumber === 'BT6-085' ? 50 : 4" placeholder="0" [(ngModel)]="card.count" mode="decimal" buttonLayout="vertical" [showButtons]="true"
      [style]="{'width': '100%'}" [inputStyle]="{'width': '100%', 'text-align': 'center'}"
      decrementButtonClass="p-button-secondary" incrementButtonClass="p-button-secondary" incrementButtonIcon="pi pi-plus" decrementButtonIcon="pi pi-minus"></p-inputNumber>
    <span *ngIf="!edit" class="primary-color font-bolder text-3xl px-2">x{{card.count}}</span>

    <p *ngIf="missingCards" class="absolute z-[100] font-bold text-6xl text-red text-black-outline missing">
      {{cardHave - card.count > 0 ? 0 : cardHave - card.count}}
    </p>
  </div>
</ng-template>

<ng-template #smallCard>
  <div class="inline-flex align-center h-[30px] my-1 ml-2">
    <button *ngIf="edit" pButton pRipple type="button" icon="pi pi-plus" class="p-button-outlined p-button-sm" (click)="addCardCount()"></button>
    <span class="primary-color font-bolder text-3xl px-2">x{{card.count}}</span>
    <button *ngIf="edit" pButton pRipple type="button" icon="pi pi-minus" class="p-button-outlined p-button-sm" (click)="reduceCardCount()"></button>

    <div class="inline-flex ml-1 border-2 border-black rounded-l-2xl min-w-[300px] w-[300px] max-w-[300px] text-xs" (click)="showCardDetails()" (contextmenu)="showCardDetails()"
         [ngStyle]="{'background-color': colorMap.get(card.color)}">
      <div *ngIf="card.cardLv === 'Lv.2'" class="px-5">
        <div class="egg mt-[4px]"></div>
      </div>
      <div *ngIf="card.cardLv !== 'Lv.2'" class="rounded-full leading-6 self-center px-3 h-full bg-sky-700 text-white text-shadow font-semibold">{{card.playCost}}</div>
      <div *ngIf="card.cardType === 'Digimon'" class="self-center px-3 text-white text-shadow font-semibold">{{transformDCost(card.digivolveCost1)}}</div>
      <div *ngIf="card.cardType === 'Tamer'" class="self-center px-3 text-white text-shadow font-semibold">Tamer</div>
      <div *ngIf="card.cardType === 'Option'" class="self-center px-3 text-white text-shadow font-semibold">Option</div>
      <div class="self-center px-1 h-full bg-black text-white leading-6 font-bold z-10">{{card.cardLv}}</div>
      <div class="bottom-top-split"></div>
      <div class="self-center text-white text-shadow text-md truncate text-center font-semibold">{{card.name}}</div>
      <div  class="ml-auto top-bottom-split"></div>
      <div class="self-center px-1 h-full bg-black  leading-6 font-bold text-white text-xs truncate">{{card.cardNumber}}</div>
    </div>
  </div>
</ng-template>
